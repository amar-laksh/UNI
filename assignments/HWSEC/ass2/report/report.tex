\documentclass[1p,16pt]{elsarticle}
\makeatletter
\def\ps@pprintTitle{%
 \let\@oddhead\@empty
 \let\@evenhead\@empty
 \def\@oddfoot{}%
 \let\@evenfoot\@oddfoot}
\makeatother

%% Use the option review to obtain double line spacing
%% \documentclass[authoryear,preprint,review,12pt]{elsarticle}

%% Use the options 1p,twocolumn; 3p; 3p,twocolumn; 5p; or 5p,twocolumn
%% for a journal layout:
%% \documentclass[final,1p,times]{elsarticle}
%% \documentclass[final,1p,times,twocolumn]{elsarticle}
%% \documentclass[final,3p,times]{elsarticle}
%% \documentclass[final,3p,times,twocolumn]{elsarticle}
%% \documentclass[final,5p,times]{elsarticle}
%% \documentclass[final,5p,times,twocolumn]{elsarticle}

%% For including figures, graphicx.sty has been loaded in
%% elsarticle.cls. If you prefer to use the old commands
%% please give \usepackage{epsfig}

%% The amssymb package provides various useful mathematical symbols
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{graphicx}
\graphicspath{ {./figures/} }
\usepackage[colorlinks]{hyperref}
\hypersetup{citecolor=DeepPink4}
\hypersetup{linkcolor=DarkRed}
\hypersetup{urlcolor=DarkBlue}
\usepackage{hyperref}
\usepackage{subcaption}
\usepackage{minted}

%% The amsthm package provides extended theorem environments
%% \usepackage{amsthm}

%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers.
%% \usepackage{lineno}

\journal{Hardware and Embedded Systems Security}

\begin{document}

\begin{frontmatter}

%% Title, authors and addresses

%% use the tnoteref command within \title for footnotes;
%% use the tnotetext command for theassociated footnote;
%% use the fnref command within \author or \address for footnotes;
%% use the fntext command for theassociated footnote;
%% use the corref command within \author for corresponding author footnotes;
%% use the cortext command for theassociated footnote;
%% use the ead command for the email address,
%% and the form \ead[url] for the home page:
%% \title{Title\tnoteref{label1}}
%% \tnotetext[label1]{}
%% \author{Name\corref{cor1}\fnref{label2}}
%% \ead{email address}
%% \ead[url]{home page}
%% \fntext[label2]{}
%% \cortext[cor1]{}
%% \address{Address\fnref{label3}}
%% \fntext[label3]{}

\title{Assignment 2: Side-Channel Analysis and Fault Injection}

%% use optional labels to link authors explicitly to addresses:
%% \author[label1,label2]{}
%% \address[label1]{}
%% \address[label2]{}

\author{Amar Lakshya (AXX945), Calvin Menezes (CXM1010)}

\address{School of Computer Science, University of Birmingham}

% \begin{abstract}
%
% \end{abstract}
%
% \begin{keyword}
% %% keywords here, in the form: keyword \sep keyword
% %% PACS codes here, in the form: \PACS code \sep code
% %% MSC codes here, in the form: \MSC code \sep code
% %% or \MSC[2008] code \sep code (2000 is the default)
%
% \end{keyword}
%
\end{frontmatter}

%% \linenumbers

%% main text
\section{Task1}
\label{Task1}
The average number of cycles per execution of the exponentiation
for $\textit{e}=17$ is:

\section{Task2}
\label{Task2}
\subsection{Oscilloscope Capture}%
\label{sub:oscilloscope_capture}
The image of the RSA operations can be seen in Fig~\ref{fig:oscilloscope}

\subsection{Manual Extraction}%
\label{sub:manual_extraction}
\textbf{TODO}

\subsection{Acquired Trace}%
\label{sub:acquired_trace}
The graph of the acquired trace can be found in Fig~\ref{fig:acquired_trace} and
\textbf{python} program file \textit{load\_trace} contains the program.

\subsection{SPA}%
\label{sub:spa}
\textbf{TODO}

\section{Task3}
\label{Task3}

\subsection{Overlapping Traces}%
\label{sub:overlapping_traces}

The plot of the first 10 traces can be seen in Fig ~\ref{fig:traces_plot}.
\par
The corresponding output can be seen below:
\begin{minted}{bash}
byte value for trace 0: D8
byte value for trace 1: E8
byte value for trace 2: 42
byte value for trace 3: 3D
byte value for trace 4: 96
byte value for trace 5: E5
byte value for trace 6: CB
byte value for trace 7: 0B
byte value for trace 8: 1F
byte value for trace 9: 33
\end{minted}{bash}

\subsection{AES XOR}%
\label{ssub:aes_xor}
The following function implements the required functionality (the complete program can be found in the aforementioned source code repository and submitted zip):

\begin{minted}{python}
def AES_XOR(x, k_prime):
    return SBOX[x ^ k_prime]
\end{minted}{python}

\subsection{Significant Bit}%
\label{sub:significant_bit}
The method to extract the \textit{MSB} involves two steps where we first convert an \textit{integer}
to a \textit{bit-field} and then we get the first element of the \textit{bit-field}.
The following is an implementation of the function in \textbf{python}:
\begin{minted}{python}
def int_to_bits(n):
    return [n >> i & 1 for i in range(BIT_SIZE-1,-1,-1)]

def MSB(n):
    return int_to_bits(n)[0]
\end{minted}{python}

\subsection{DPA}%
\label{sub:dpa}
The submitted program file \textit{dpa.py} contains the program to produce the overlapping graphs
of all difference-of-means curves as seen in Fig ~\ref{fig:peaks_plot} and the zoomed-in part
showing the candidate key $K10=7$ as seen in Fig ~\ref{fig:peak_plot}.



\section{Task4}
\label{Task4}
\subsection{Fault Injection on RSA-CRT}%
\label{sub:fault_injection_on_rsa_crt}
From the given values
$n=91, e=5, S=48, \overline{S}=35, x=55$
we calculate the valid signature $y$ by:
\begin{align}
	y &= x^e \mod n \\
	y &= 55^5 \mod 91 \\
	y & = 48
\end{align}

\subsubsection{Using Bellcore Method}%
\label{sub:ballcore_method}
The bellcore method gives factor $q$ by:
\begin{align}
	q &= gcd(S - \overline{S}, n) \\
	q &= gcd(48 - 35, 91) \\
	q &= gcd(13, 91) \\
	q &= 13
\end{align}

we know $n = p * q$ therefore factor $p$ is:
\begin{align}
	p &= n / q \\
	p &= 91 / 13 \\
	p &= 7
\end{align}


\subsubsection{Using Lenstra Method}%
\label{sub:lenstra_method}
The Lenstra method gives factor $q$ by:
\begin{align}
	q &= gcd(\overline{Y}^e - x, n) \\
\end{align}

From eq 1, we know that $y=48$ and since
$\overline{y} = y, \overline{y} = 48$, therefore

\begin{align}
	q &= gcd(48^5 - 55, 91) \\
	q &= gcd(48 - 55, 91) \\
	q &= gcd(7, 91) \\
	q &= 7
\end{align}

we know $n = p * q$ therefore factor $p$ is:

\begin{align}
	p &= n / q \\
	p &= 91 / 7 \\
	p &= 13
\end{align}

The major advantage of Lenstra method is that only the faulty value $\overline{S}$ needs to be known.



\subsection{Counter Measures}%
\label{sub:counter_measures}
\bf{TODO}

%% The Appendices part is started with the command \appendix;
%% appendix sections are then done as normal sections
%% \appendix

%% \section{}
%% \label{}

%% If you have bibdatabase file and want bibtex to generate the
%% bibitems, please use
%%
% \bibliographystyle{elsarticle-num}
% \bibliography{bibliography}
%
\newpage
\section{Appendices}%
\label{sec:appendices}


\begin{figure}[hb]
	\centering
    \centerline{\includegraphics[width=8cm]{oscilloscope}}
    \caption{The picture of oscilloscope showing the first 6 operations of RSA}\label{fig:oscilloscope}
\end{figure}

\begin{figure}[hb]
	\centering
    \centerline{\includegraphics[width=10cm]{trace_plot}}
    \caption{Graph of the acquire trace in full scale}\label{fig:acquired_trace}
\end{figure}

\begin{figure}[hb]
	\centering
    \centerline{\includegraphics[width=10cm]{traces_plot}}
    \caption{Graph of superimposed 10 traces}\label{fig:traces_plot}
\end{figure}

\begin{figure}[hb]
	\centering
    \centerline{\includegraphics[width=10cm]{peaks_plot}}
    \caption{Graph of superimposed difference-of-means}\label{fig:peaks_plot}
\end{figure}

\begin{figure}[hb]
	\centering
    \centerline{\includegraphics[width=10cm]{peak_plot}}
    \caption{Graph of zoomed-in part of difference-of-means}\label{fig:peak_plot}
\end{figure}
%% else use the following coding to input the bibitems directly in the
%% TeX file.

% \begin{thebibliography}{00}
%
% %% Text of bibliographic item%
% \end{thebibliography}
\end{document}
\endinput
%%
%% End of file `elsarticle-template-num.tex'.
